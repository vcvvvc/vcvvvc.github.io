<!doctype html>
<html lang="en-us">
  <head>
    <title>Tcp_ip // Vcvc Blog</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.83.1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Vcvc" />
    
    <meta name="description" content="用文字记录经验， 个人了解金融证券、商务、计算机、周易。" />
    <meta name="keywords" content="Vcvc,Vcvc Blog,CPP,Open Source,Python,Linux" />
    <link rel="stylesheet" href="https://6923403.github.io/css/main.min.c2052924716d810662c2cc67f9223190e814e1923e41ea4b9647c5c71b6ce3b6.css" />
    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Tcp_ip"/>
<meta name="twitter:description" content="计算机体系结构 各层作用及协议    分层 作用 协议     物理层 通过媒介传输比特，确定机械及电气规范（比特 Bit） RJ45、CLOCK、IEEE802.3（中继器，集线器）   数据链路层 将比特组装成帧和点到点的传递（帧 Frame） PPP、FR、HDLC、VLAN、MAC（网桥，交换机）   网络层 负责数据包从源到宿的传递和网际互连（包 Packet） IP、ICMP、ARP、RARP、OSPF、IPX、RIP、IGRP（路由器）   运输层 提供端到端的可靠报文传递和错误恢复（ 段Segment） TCP、UDP、SPX   会话层 建立、管理和终止会话（会话协议数据单元 SPDU） NFS、SQL、NETBIOS、RPC   表示层 对数据进行翻译、加密和压缩（表示协议数据单元 PPDU） JPEG、MPEG、ASII   应用层 允许访问OSI环境的手段（应用协议数据单元 APDU） FTP、DNS、Telnet、SMTP、HTTP、WWW、NFS     封装  链路层 链路层主要有三个目的：
 为IP模块发送和接收IP数据报； 为ARP模块发送ARP请求和接收ARP应答； 为RARP发送RARP请求和接收RARP应答。  PPP（点到点协议）是为在同等单元之间传输数据包这样的简单链路设计的链路层协议。
环回接口
re: mtu
 网络层  IP（Internet Protocol，网际协议）是为计算机网络相互连接进行通信而设计的协议。 ARP（Address Resolution Protocol，地址解析协议） ICMP（Internet Control Message Protocol，网际控制报文协议） IGMP（Internet Group Management Protocol，网际组管理协议）  IP是TCP/IP协议族中最为核心的协议。所有的TCP、UDP、ICMP及IGMP数据都以IP数据报格式传输"/>

    <meta property="og:title" content="Tcp_ip" />
<meta property="og:description" content="计算机体系结构 各层作用及协议    分层 作用 协议     物理层 通过媒介传输比特，确定机械及电气规范（比特 Bit） RJ45、CLOCK、IEEE802.3（中继器，集线器）   数据链路层 将比特组装成帧和点到点的传递（帧 Frame） PPP、FR、HDLC、VLAN、MAC（网桥，交换机）   网络层 负责数据包从源到宿的传递和网际互连（包 Packet） IP、ICMP、ARP、RARP、OSPF、IPX、RIP、IGRP（路由器）   运输层 提供端到端的可靠报文传递和错误恢复（ 段Segment） TCP、UDP、SPX   会话层 建立、管理和终止会话（会话协议数据单元 SPDU） NFS、SQL、NETBIOS、RPC   表示层 对数据进行翻译、加密和压缩（表示协议数据单元 PPDU） JPEG、MPEG、ASII   应用层 允许访问OSI环境的手段（应用协议数据单元 APDU） FTP、DNS、Telnet、SMTP、HTTP、WWW、NFS     封装  链路层 链路层主要有三个目的：
 为IP模块发送和接收IP数据报； 为ARP模块发送ARP请求和接收ARP应答； 为RARP发送RARP请求和接收RARP应答。  PPP（点到点协议）是为在同等单元之间传输数据包这样的简单链路设计的链路层协议。
环回接口
re: mtu
 网络层  IP（Internet Protocol，网际协议）是为计算机网络相互连接进行通信而设计的协议。 ARP（Address Resolution Protocol，地址解析协议） ICMP（Internet Control Message Protocol，网际控制报文协议） IGMP（Internet Group Management Protocol，网际组管理协议）  IP是TCP/IP协议族中最为核心的协议。所有的TCP、UDP、ICMP及IGMP数据都以IP数据报格式传输" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://6923403.github.io/post/tcp_ip/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-02-25T14:28:11&#43;08:00" />
<meta property="article:modified_time" content="2021-02-25T14:28:11&#43;08:00" />


  </head>
  <body>
    <header class="app-header">
      <a href="https://6923403.github.io"><img class="app-header-avatar" src="/avatar.jpg" alt="Vcvc" /></a>
      <h1>Vcvc Blog</h1>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">Home</a>
             - 
          
          <a class="app-header-menu-item" href="/tags/">Tags</a>
             - 
          
          <a class="app-header-menu-item" href="/about/">About</a>
      </nav>
      <p> Amateur Financer.</p>
      <div class="app-header-social">
        
          <a href="https://github.com/6923403" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="https://twitter.com/vcvckw" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-twitter">
  <title>Twitter</title>
  <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path>
</svg>
          </a>
        
          <a href="mailto:vcvckw@gmail.com" target="_blank" rel="noreferrer noopener">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-mail">
  <title>mail</title>
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline>
</svg>
          </a>
        
        
        <a href="/vcvc/index.html" target="_blank">
          <img  border="0" src="/vcvc/arrow.png" alt="Home" width="24" height="24"></a>
      <template id="mdl-wb__search-result" hidden>
        <article class="content post">
          <h4 class="post-title"><a class="search-result__link"></a></h4>
          <p class="search-result__summary"></p>
          <div>
            <span class="mdl-button mdl-js-button mdl-button--accent" role="button"><a class="search-result__button">Expand Result</a></span>
          </div>
        </article>
      </template>
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Tcp_ip</h1>
      <div class="post-meta">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Feb 25, 2021
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          1 min read
        </div>
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
</svg>
              <a class="tag" href="https://6923403.github.io/tags/tcp/">TCP</a>
              <a class="tag" href="https://6923403.github.io/tags/ip/">IP</a>
              <a class="tag" href="https://6923403.github.io/tags/udp/">UDP</a>
              <a class="tag" href="https://6923403.github.io/tags/socket/">Socket</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="计算机体系结构">计算机体系结构</h1>
<p><img src="/img/tcp_ip/q2.png" alt="q2"></p>
<h1 id="各层作用及协议">各层作用及协议</h1>
<table>
<thead>
<tr>
<th style="text-align:left">分层</th>
<th style="text-align:left">作用</th>
<th style="text-align:left">协议</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">物理层</td>
<td style="text-align:left">通过媒介传输比特，确定机械及电气规范（比特 Bit）</td>
<td style="text-align:left">RJ45、CLOCK、IEEE802.3（中继器，集线器）</td>
</tr>
<tr>
<td style="text-align:left">数据链路层</td>
<td style="text-align:left">将比特组装成帧和点到点的传递（帧 Frame）</td>
<td style="text-align:left">PPP、FR、HDLC、VLAN、MAC（网桥，交换机）</td>
</tr>
<tr>
<td style="text-align:left">网络层</td>
<td style="text-align:left">负责数据包从源到宿的传递和网际互连（包 Packet）</td>
<td style="text-align:left">IP、ICMP、ARP、RARP、OSPF、IPX、RIP、IGRP（路由器）</td>
</tr>
<tr>
<td style="text-align:left">运输层</td>
<td style="text-align:left">提供端到端的可靠报文传递和错误恢复（ 段Segment）</td>
<td style="text-align:left">TCP、UDP、SPX</td>
</tr>
<tr>
<td style="text-align:left">会话层</td>
<td style="text-align:left">建立、管理和终止会话（会话协议数据单元 SPDU）</td>
<td style="text-align:left">NFS、SQL、NETBIOS、RPC</td>
</tr>
<tr>
<td style="text-align:left">表示层</td>
<td style="text-align:left">对数据进行翻译、加密和压缩（表示协议数据单元 PPDU）</td>
<td style="text-align:left">JPEG、MPEG、ASII</td>
</tr>
<tr>
<td style="text-align:left">应用层</td>
<td style="text-align:left">允许访问OSI环境的手段（应用协议数据单元 APDU）</td>
<td style="text-align:left">FTP、DNS、Telnet、SMTP、HTTP、WWW、NFS</td>
</tr>
</tbody>
</table>
<hr>
<h1 id="封装">封装</h1>
<p><img src="/img/tcp_ip/q1.png" alt="q1"></p>
<hr>
<h1 id="链路层">链路层</h1>
<p><strong>链路层主要有三个目的：</strong></p>
<ol>
<li>为IP模块发送和接收IP数据报；</li>
<li>为ARP模块发送ARP请求和接收ARP应答；</li>
<li>为RARP发送RARP请求和接收RARP应答。</li>
</ol>
<p>PPP（点到点协议）是为在同等单元之间传输数据包这样的简单链路设计的链路层协议。</p>
<p><strong>环回接口</strong></p>
<p><img src="/img/tcp_ip/q3.png" alt="q3"></p>
<p>re: <a href="https://developer.aliyun.com/article/222535">mtu</a></p>
<hr>
<h1 id="网络层">网络层</h1>
<ul>
<li>IP（Internet Protocol，网际协议）是为计算机网络相互连接进行通信而设计的协议。</li>
<li>ARP（Address Resolution Protocol，地址解析协议）</li>
<li>ICMP（Internet Control Message Protocol，网际控制报文协议）</li>
<li>IGMP（Internet Group Management Protocol，网际组管理协议）</li>
</ul>
<p><strong>IP是TCP/IP协议族中最为核心的协议。所有的TCP、UDP、ICMP及IGMP数据都以IP数据报格式传输</strong></p>
<p><strong>不可靠（unreliable）的意思是它不能保证IP数据报能成功地到达目的地。IP仅提供最好的传输服务。</strong></p>
<p><strong>无连接（connectionless）这个术语的意思是IP并不维护任何关于后续数据报的状态信息。每个数据报的处理是相互独立的。</strong></p>
<p><img src="/img/tcp_ip/q4.png" alt="q4"></p>
<p><img src="/img/tcp_ip/q5.png" alt="q5"></p>
<p><strong>IP 地址分类:</strong></p>
<ul>
<li>IP 地址 ::= {&lt;网络号&gt;,&lt;主机号&gt;}</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">IP地址类别</th>
<th style="text-align:left">网络号</th>
<th style="text-align:left">网络范围</th>
<th style="text-align:right">主机号</th>
<th style="text-align:right">IP地址范围</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">A 类</td>
<td style="text-align:left">8bit，第一位固定为0</td>
<td style="text-align:left">0——127</td>
<td style="text-align:right">24bit</td>
<td style="text-align:right">1.0.0.0——127.255.255.255</td>
</tr>
<tr>
<td style="text-align:left">B 类</td>
<td style="text-align:left">16bit，前两位固定为10</td>
<td style="text-align:left">128.0——191.255</td>
<td style="text-align:right">16bit</td>
<td style="text-align:right">128.0.0.0——191.255.255.255</td>
</tr>
<tr>
<td style="text-align:left">C 类</td>
<td style="text-align:left">24bit，前三位固定为110</td>
<td style="text-align:left">192.0.0——223.255.255</td>
<td style="text-align:right">8bit</td>
<td style="text-align:right">192.0.0.0——223.255.255.255</td>
</tr>
<tr>
<td style="text-align:left">D 类</td>
<td style="text-align:left">前四位固定为1110，后面为多播地址</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:left">E 类</td>
<td style="text-align:left">前五位固定为11110，后面保留为今后所用</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="arp-地址解析协议">ARP 地址解析协议</h2>
<p><strong>ARP为IP地址到对应的硬件地址之间提供动态映射。</strong></p>
<p><strong>RARP是被那些没有磁盘驱动器的系统使用（一般是无盘工作站或 X终端），它需要系统管理员进行手工设置。</strong></p>
<p><img src="/img/tcp_ip/q6.png" alt="q6"></p>
<p><strong>ARP高效运行的关键是由于每个主机上都有一个ARP高速缓存。可以用<code>apr -a</code>来进行检查ARP高速缓存</strong></p>
<p><strong>ARP分组格式</strong></p>
<p><img src="/img/tcp_ip/q7.png" alt="q7"></p>
<p><strong>ARP实例</strong></p>
<p><img src="/img/tcp_ip/arp1.png" alt="arp1"></p>
<h2 id="rarp-逆地址解析协议">RARP 逆地址解析协议</h2>
<p>RARP协议是许多无盘系统在引导时用来获取IP地址的。RARP分组格式基本上与ARP分组一致。一个RARP请求在网络上进行广播，它在分组中标明发送端的硬件地址，以请求相应IP地址的响应。应答通常是单播传送的。</p>
<h2 id="icmp-网际控制报文协议">ICMP 网际控制报文协议</h2>
<p><strong>ICMP经常被认为是IP层的一个组成部分。它传递差错报文以及其他需要注意的信息。</strong></p>
<p><strong>ICMP报文通常被IP层或更高层协议（TCP或UDP）使用。一些ICMP报文把差错报文返回给用户进程。</strong></p>
<p><strong>ICMP报文是在IP数据报内部被传输的</strong></p>
<p><img src="/img/tcp_ip/q8.png" alt="q8"></p>
<p><strong>检验和字段覆盖整个ICMP报文。</strong></p>
<p><img src="/img/tcp_ip/q9.png" alt="q9"></p>
<h3 id="icmp报文类型">ICMP报文类型</h3>
<p><img src="/img/tcp_ip/q10.png" alt="q10"></p>
<p><strong>下面各种情况都不会导致产生ICMP差错报文:</strong></p>
<ul>
<li>ICMP差错报文（但是，ICMP查询报文可能会产生ICMP差错报文）。</li>
<li>目的地址是广播地址或多播地址（D类地址）的IP数据报。</li>
<li>作为链路层广播的数据报。</li>
<li>不是IP分片的第一片。</li>
<li>源地址不是单个主机的数据报。这就是说，源地址不能为零地址、环回地址、广播地
址或多播地址。</li>
</ul>
<p><img src="/img/tcp_ip/q11.png" alt="q11"></p>
<p><img src="/img/tcp_ip/q12.png" alt="q12"></p>
<p><img src="/img/tcp_ip/q13.png" alt="q13"></p>
<p><img src="/img/tcp_ip/q14.png" alt="q14"></p>
<p>对于其他类型的ICMP查询报文，服务器必须响应标识符和序列号字段。另外，客户发送的选项数据必须回显，假设客户对这些信息都会感兴趣。</p>
<h2 id="ping程序">ping程序</h2>
<p><img src="/img/tcp_ip/q15.png" alt="q15"></p>
<p><strong>IP数据报中的RR选项的一般格式</strong></p>
<p><img src="/img/tcp_ip/q16.png" alt="q16"></p>
<hr>
<h1 id="运输层-tcpudp">运输层 tcp—udp</h1>
<p><strong>UDP（User Datagram Protocol，用户数据报协议）是 OSI（Open System Interconnection 开放式系统互联） 参考模型中一种无连接的传输层协议，提供面向事务的简单不可靠信息传送服务，其传输的单位是用户数据报。</strong></p>
<p><img src="/img/tcp_ip/q17.png" alt="q17"></p>
<p><strong>UDP首部</strong></p>
<p><img src="/img/tcp_ip/q18.png" alt="q18"></p>
<h3 id="udp数据报中的伪首部">UDP数据报中的伪首部</h3>
<p><strong>UDP数据报和TCP段都包含一个12字节长的伪首部，它是为了计算检验和而设置的。其目的是让UDP两次检查数据是否已经正确到达目的地。</strong></p>
<p><img src="/img/tcp_ip/q19.png" alt="q19"></p>
<h2 id="ip分片">IP分片</h2>
<p><img src="/img/tcp_ip/q20.png" alt="q20"></p>
<ul>
<li>在分片时，除最后一片外，其他每一片中的数据部分（除 I P首部外的其余部分）必须是 8
字节的整数倍。</li>
<li>位于@符号后的数字是从数据报开始处计算的片偏移值。</li>
<li>IP数据报是指IP层端到端的传输单元（在分片之前和重新组装之后）</li>
<li>分组是指在IP层和链路层之间传送的数据单元。</li>
<li>一个分组可以是一个完整的IP数据报，也可以是IP数据报的一个分片。</li>
</ul>
<p><img src="/img/tcp_ip/q21.png" alt="q21"></p>
<h2 id="icmp不可达差错">ICMP不可达差错</h2>
<p><strong>发生ICMP不可达差错的另一种情况是，当路由器收到一份需要分片的数据报，而在IP首部又设置了不分片（DF）的标志比特。如果路由器没有提供这种新的ICMP差错报文格式，那么下一站的MTU就设为0。</strong></p>
<p><img src="/img/tcp_ip/q22.png" alt="q22"></p>
<hr>
<p><strong>ip数据报格式:</strong> <a href="https://www.jianshu.com/p/d3f9e70c6220">https://www.jianshu.com/p/d3f9e70c6220</a></p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>
<br />
<hr width = "450" color="#eeeeee" align="left">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="/vcvc/license.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
<br />
<br />
<hr width = "450" color="#eeeeee" align="left">

<div id="gitalk-container"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script>
    const gitalk = new Gitalk({
        clientID: '21b0d923081673c4c523',
        clientSecret: '39264d5c26bb7e184d3a97f99cc2844caea7f417',
        repo: '6923403.github.io',
        owner: '6923403',
        admin: ['6923403'],
        id: location.pathname, 
        distractionFreeMode: false 
    });
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('gitalk-container').innerHTML = 'Gitalk comments not available by default when the website is previewed locally.';
            return;
        }
        gitalk.render('gitalk-container');
    })();
</script>


    </main>
  </body>
</html>
